---
message: "This node is using global data"

#Puppet Server Tuning
puppet_enterprise::master::puppetserver::jruby_max_requests_per_instance: 10000
#Enable code manager
puppet_enterprise::profile::master::code_manager_auto_configure: true
puppet_enterprise::master::code_manager::authenticate_webhook: false

#pe-console-services tuning
#https://docs.puppetlabs.com/pe/latest/console_config.html#tuning-the-classifier-synchronization-period
#disable classifier scheduled sync and rely on r10k postrun command to sync the classes
puppet_enterprise::profile::console::classifier_synchronization_period: 0

# Data for the puppetlabs NTP module
#   which interfaces will accept connections
ntp::restrict:
  - 'default kod nomodify notrap nopeer noquery'
  - '-4 default kod notrap nomodify nopeer noquery'
  - '-6 default kod nomodify notrap nopeer noquery'
  - '127.0.0.1'
  - '::1'
ntp::servers:
  - 'time01.samdom.aussieswithtails.fuzzbutt' # ToDo: use fqdn?

virtualbox::version: '5.0'

hiera::hiera_yaml: '/etc/puppetlabs/code/hiera.yaml' # FixMe - can it be paramaratized
hiera::master_service: 'puppetserver'
hiera::hierarchy:
  - "nodes/%{literal('%')}{trusted.certname}"
  - "tier/%{literal('%')}{tier}"
  - global

awt::ssh::key_type: 'rsa'
awt::ssh::key_size: '4096'

# btrfs
awt::btrfs::admin_mountpoint: '/mnt/btrfs'
awt::server_home: '/srv'
awt::nologin_shell: '/usr/sbin/nologin'

# Gitolite settings
# Note that we don't let gitolite manage the user or home directory
# This reflects two issues:
# - The need to setup a btrfs subvolume
# - The puppet mount resource behavior which doesn't respect the underlying
#   directory ownerships - changes them to root which requires a hack to
#   work around.
#gitolite::admin_key_source: "%{hiera('gitolite::home_dir')}/.ssh/id_%{hiera('awt::ssh::key_type')}.pub"
#gitolite::admin_key_source: "/home/administrator/.ssh/id_rsa.pub"
gitolite::admin_key_content: 'AAAAB3NzaC1yc2EAAAADAQABAAACAQC9XBfVgdWZP/RkHn7wQ5c58oGLRfx6rMAVBJaNPIVqb838JYVZjbvhq+OJ2rz6aX8dOKjZI456R/sjdsv0Qwwui6DQ7HHUfxlmTZ2vgHUDvE/gOZxS85QcBoWPY5nZ3eh4ih1NvF5RicNursZknzPMVx8E1Cs4W9sPNACD8BGra27CGpbzAb971MiQUxk7JGBOckNXEjeZKuu/h8UkCMCLkFZiYEioHefIUAvmjGJrmoH/JvmenPP08sHnTtGkhI1i+uPPmm7Wl/CjfoeOmoos2fdxq8PS5xKfB2iGZRZpoKnrDjKiH56gAnn1WMUkxYhxomWGkGme7JWZXx6Bd/RjPme5igdWFJCks/uAy71H22dz40G1t9o6zqc9Q+hxJSCVQf0qpfc5PTK89e1zR+uoxI4R/PAQGz0K/yEXOnstHAeRH/SC6kzc657nGS+sZJITeo57/BFYxOAZeAi4hi0s2KVRSENWb093mxGS6+TFJBJNWzqlRXVbFQcTqE6ID+LL+75GLmfK+xmC7HMJMHapZM5SnsuLbvDoW2FLQTbQme69HYUJjhaL8qdWtub9q9Fto5GWbjnBbeW61BP0bv4GjuRIsqL4MkgZqHNvDjFCkaNUbpu4ipW7CnmFnnXz6Y9wxrDmbGHD6IXaxIuNRSyJHje2sV/F05yj5a//z5z4IQ=='
gitolite::manage_home_dir: false
gitolite::manage_user: false
gitolite::group_name: 'gitolite'
gitolite::user_name: 'gitolite'
gitolite::home_dir: '/srv/gitolite'
